#  模板及其实例化详细分析
## 7.1  模板及其实例化详细分析
### 一：函数模板
编译器编译时，根据针对funcadd()的调用来确定T的类型。
如果我们并没有针对funcadd()的调用代码，那么编译器不会为我们产生任何和funcadd有关的代码，就好像函数模板funcadd()从来没存在过一样；
```cpp
	template <class T>   //针对T的类型推断，是编译器在编译的时候，根据针对funcadd()的调用来确定的
	T funcadd(const T&a, const T& b)
	{
		T addhe = a + b;
		return addhe;
	}
	void func()
	{
		cout << funcadd(12, 14) << endl; 


		return;
	}
```

### 二：类模板的实例化分析
如果程序代码中没有用到类模板ATPL，那么编译器对ATPL类模板视而不见，就好像从来没存在过一样；
（2.1）模板中的枚举类型，和类模板本身关系不大
（2.2）类模板中的静态成员变量
（2.3）类模板的实例化
1. 类模板指针不会实例化
2. 类模板引用会实例化
（2.4）成员函数的实例化
1. 实例化类模板，在不调用成员函数的情况下，不会实例化

### 三:多个源文件中使用类模板
 在多个obj文件中可能产生多个重复的类模板对应的具体的实例化类，但链接的时候只会保留一个ATPL<int>类的实体，其余的会被忽略掉；
（3.1）虚函数的实例化
虚函数即使没有被调用，但也会被实例化出来，为什么？因为有虚函数，编译器就会产生虚函数表。虚函数表里是各个虚函数的地址，既然需要各个虚函数的地址，那么必须要实例化每个虚函数出来。
（3.2）显式实例化

## 7.2 邪门歪道
### 一：不能被继承的类B
    c++11 final关键字；
	友元函数+虚继承   = 不能被继承的类
	副作用：友元，破坏封装性；虚继承，消耗比较大；
```cpp
    class A
	{
	private:
		A() 
		{
			int abc;
			abc = 12;
		}
		friend class B;  //我们希望类B能够成为一个不能被继承的类
	};
	//class B :public A
	class B : virtual public A
	{
	public:
		int m_b;
	};

	//我希望类B不能被继承
	class C :public B
	{
	public:
		int m_c;
	};

	void func()
	{	
		//A objba; //构造函数私有，所以生成A对象不可以

		B myobjb;
		myobjb.m_b = 15;

		/*C myobjc;
		myobjc.m_c = 20;*/

		return;
	}
```

### 二：类外调用私有虚成员函数
```cpp	
    class A
	{
	private :
		virtual void virfunc()
		{
			myfunc();
		}
		void myfunc()
		{
			cout << "myfunc() run---------" << endl;
		}
	};

	void func()
	{
		A obj;
		//(reinterpret_cast<void(*)()>(**(int **)(&obj)))(); //调用虚函数virfunc();
		                           //无非就是走虚函数表来调用虚函数，这些知识咱们都讲过，尤其是三章二节详细写过手工调用虚函数的代码；
		long *pvptr = (long *)&obj; //把对象obj的地址拿到
		long *vptr = (long *)(*pvptr); //拿到虚函数表指针
		typedef void(*Func)(void); //定义个函数指针类型
		Func f = (Func)vptr[0]; //给虚函数表指针f赋值为第一个虚函数地址virfunc
		f(); //调用虚函数

	}
```

## 推荐书籍、结束语
### 四：结束语，学习之道（c++之道）
持之以恒，不断努力~~~
    (1)选对老师
    (2)走对路

    建议：
    (1)学精不要学杂，不要贪大求全，否则会分散精力，浪费时间
    (2)尽早选择一条能拿高薪的路，一直不断的努力达成目的；

	推荐三门课，不需要多学，按顺序从初级到高级，
	《c语言入门》
	《c++从入门到精通c++98/11/14/17》
	《c++对象模型探索》：你是司机，你会开车了，你还会修车；
	10-20k
	c++开发之路刚刚开始，要选择深造的方向了；
	图形学，游戏服务器，网络通讯架构，虚拟现实，嵌入式系统，设备驱动，音频视频，ai底层。
	50-80K/月薪 ,网络通讯架构能够拿到这个月薪；
	《linux c++通讯架构实战》 --30K 一年左右；